<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NexPlayy | Admin Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>

    <!-- Navigation -->
    <nav id="navbar" class="nav-bar scrolled">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-crown"></i> NexPlayy Admin
            </div>
            <div class="nav-actions">
                <a href="index.html" class="btn btn-outline">View Site</a>
                <a href="#" onclick="logout()" class="btn btn-outline">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Login Screen -->
    <div id="loginGate" class="admin-login">
        <div class="glass" style="padding: 40px; width: 100%; max-width: 400px; text-align: center;">
            <h2 style="margin-bottom: 30px; color: var(--primary-color);">üîê Admin Access</h2>
            <div class="form-group">
                <label>Enter Admin Password</label>
                <input type="password" id="adminPassword" placeholder="Password" onkeypress="if(event.key==='Enter')checkLogin()">
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="checkLogin()">Login</button>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="admin-container" style="display: none;">
        <!-- Hero Section Controls -->
        <div class="admin-card">
            <h3><i class="fas fa-heading"></i> Hero Section</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div class="form-group">
                    <label>Main Title</label>
                    <textarea id="heroTitle" onchange="updateHeroData()" style="min-height: 80px;"></textarea>
                </div>
                <div class="form-group">
                    <label>Subtitle</label>
                    <textarea id="heroSub" onchange="updateHeroData()" style="min-height: 80px;"></textarea>
                </div>
            </div>
        </div>

        <!-- Banners Management -->
        <div class="admin-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3><i class="fas fa-image"></i> Website Banners</h3>
                <button class="btn btn-primary btn-small" onclick="openBannerModal()">+ Add Banner</button>
            </div>
            <div id="bannersList" style="margin-top: 20px;"></div>
        </div>

        <!-- Range Controls -->
        <div class="admin-card">
            <h3><i class="fas fa-list"></i> Price Ranges</h3>
            <div style="display: flex; gap: 12px; align-items: center; margin-top: 15px;">
                <input type="text" id="newRangeValue" placeholder="e.g. 249" style="flex: 1; max-width: 200px; padding: 10px 15px; background: rgba(255,255,255,0.05); border: 1px solid rgba(0,245,255,0.2); border-radius: 6px; color: #fff;">
                <button class="btn btn-primary btn-small" onclick="addRange()">Add Range</button>
            </div>
            <div id="rangesList" style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;"></div>
        </div>

        <!-- Featured Games Management -->
        <div class="admin-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3><i class="fas fa-fire"></i> Featured Carousel</h3>
                <button class="btn btn-primary btn-small" onclick="openFeaturedModal()">+ Add Featured</button>
            </div>
            <div id="featuredAdminList" style="margin-top: 20px;"></div>
        </div>

        <!-- Bundles Management -->
        <div class="admin-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3><i class="fas fa-gift"></i> Game Bundles</h3>
                <button class="btn btn-primary btn-small" onclick="openBundleModal()">+ Add Bundle</button>
            </div>
            <div id="bundlesAdminList" style="margin-top: 20px;"></div>
        </div>

        <!-- Game Inventory -->
        <div class="admin-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <h3><i class="fas fa-gamepad"></i> Game Inventory</h3>
                <button class="btn btn-primary btn-small" onclick="openGameModal()">+ Add Game</button>
            </div>
            <div id="gamesList" style="margin-top: 20px; max-height: 600px; overflow-y: auto;"></div>
        </div>

        <!-- Site Settings -->
        <div class="admin-card">
            <h3><i class="fas fa-sliders-h"></i> Site Settings</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div class="form-group">
                    <label>Carousel Autoplay</label>
                    <select id="sAutoplay" onchange="updateSettings()">
                        <option value="true">Enabled</option>
                        <option value="false">Disabled</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Autoplay Interval (ms)</label>
                    <input type="number" id="sAutoplayInterval" value="5000" onchange="updateSettings()">
                </div>
            </div>
        </div>
    </div>

    <!-- Banner Modal -->
    <div id="bannerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add/Edit Banner</h2>
                <button class="close-btn" onclick="closeBannerModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Banner Title</label>
                <input type="text" id="bannerTitle" placeholder="e.g. Summer Sale">
            </div>
            <div class="form-group">
                <label>Banner Description</label>
                <textarea id="bannerDesc" placeholder="Banner description" style="min-height: 80px;"></textarea>
            </div>
            <div class="form-group">
                <label>Banner Link (optional)</label>
                <input type="text" id="bannerLink" placeholder="https://...">
            </div>
            <button class="btn btn-primary" onclick="saveBanner()" style="width: 100%;">Save Banner</button>
        </div>
    </div>

    <!-- Featured Modal -->
    <div id="featuredModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Featured Game</h2>
                <button class="close-btn" onclick="closeFeaturedModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Game Name</label>
                <select id="featuredGameName">
                    <option>Select a game...</option>
                </select>
            </div>
            <div class="form-group">
                <label>Featured Note</label>
                <input type="text" id="featuredNote" placeholder="e.g. New Release, Best Seller">
            </div>
            <button class="btn btn-primary" onclick="saveFeatured()" style="width: 100%;">Add to Featured</button>
        </div>
    </div>

    <!-- Bundle Modal -->
    <div id="bundleModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Create Bundle</h2>
                <button class="close-btn" onclick="closeBundleModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Bundle Name</label>
                <input type="text" id="bundleName" placeholder="e.g. Horror Games Bundle">
            </div>
            <div class="form-group">
                <label>Bundle Description</label>
                <textarea id="bundleDesc" placeholder="Bundle description" style="min-height: 80px;"></textarea>
            </div>
            <div class="form-group">
                <label>Select Games</label>
                <div id="bundleGamesList" style="max-height: 300px; overflow-y: auto; border: 1px solid rgba(0,245,255,0.2); border-radius: 6px; padding: 10px;"></div>
            </div>
            <button class="btn btn-primary" onclick="saveBundle()" style="width: 100%; margin-top: 15px;">Create Bundle</button>
        </div>
    </div>

    <!-- Game Modal -->
    <div id="gameModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add/Edit Game</h2>
                <button class="close-btn" onclick="closeGameModal()">&times;</button>
            </div>
            <div class="form-group">
                <label>Game Name</label>
                <input type="text" id="gameName" placeholder="Game name">
            </div>
            <div class="form-group">
                <label>Price (‚Çπ)</label>
                <input type="number" id="gamePrice" placeholder="Price">
            </div>
            <div class="form-group">
                <label>Original Price (‚Çπ)</label>
                <input type="number" id="gameOldPrice" placeholder="Original price (optional)">
            </div>
            <div class="form-group">
                <label>Price Range</label>
                <select id="gameRange">
                    <option>Select range...</option>
                </select>
            </div>
            <div class="form-group">
                <label>Platform</label>
                <input type="text" id="gamePlatform" placeholder="e.g. PC / PS5 / Xbox">
            </div>
            <div class="form-group">
                <label>Image URL</label>
                <input type="text" id="gameImage" placeholder="https://...">
            </div>
            <div class="form-group">
                <label>Badge (optional)</label>
                <input type="text" id="gameBadge" placeholder="e.g. NEW, HOT, POPULAR">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="gameDesc" placeholder="Game description" style="min-height: 80px;"></textarea>
            </div>
            <button class="btn btn-primary" onclick="saveGame()" style="width: 100%;">Save Game</button>
        </div>
    </div>

    <script>
        const ADMIN_PASSWORD = 'NexPlayy@2026';
        let editingBannerId = null;
        let editingGameIdx = null;

        function checkLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('loginGate').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            } else {
                alert('Incorrect password');
            }
        }

        function logout() {
            document.getElementById('loginGate').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }

        function loadDashboard() {
            loadHeroData();
            loadRanges();
            loadBanners();
            loadFeatured();
            loadBundles();
            loadGames();
            loadSettings();
        }

        function loadHeroData() {
            const heroData = JSON.parse(localStorage.getItem('nexplayy_hero')) || {};
            document.getElementById('heroTitle').value = heroData.title || 'LEVEL UP YOUR GAMING LIBRARY';
            document.getElementById('heroSub').value = heroData.sub || 'Premium games at legendary prices';
        }

        function updateHeroData() {
            const heroData = {
                title: document.getElementById('heroTitle').value,
                sub: document.getElementById('heroSub').value
            };
            localStorage.setItem('nexplayy_hero', JSON.stringify(heroData));
            alert('Hero section updated!');
        }

        function loadRanges() {
            const rangesData = JSON.parse(localStorage.getItem('nexplayy_ranges')) || [];
            const list = document.getElementById('rangesList');
            list.innerHTML = '';
            rangesData.forEach(r => {
                const tag = document.createElement('span');
                tag.className = 'item-tag delete';
                tag.innerHTML = `‚Çπ${r} <small style="cursor:pointer;margin-left:8px;">‚úï</small>`;
                tag.onclick = () => deleteRange(r);
                list.appendChild(tag);
            });
        }

        function addRange() {
            const value = document.getElementById('newRangeValue').value.trim();
            if (!value) return alert('Enter a range value');
            
            let ranges = JSON.parse(localStorage.getItem('nexplayy_ranges')) || [];
            if (!ranges.includes(value)) {
                ranges.push(value);
                localStorage.setItem('nexplayy_ranges', JSON.stringify(ranges));
                document.getElementById('newRangeValue').value = '';
                loadRanges();
                alert('Range added!');
            }
        }

        function deleteRange(range) {
            let ranges = JSON.parse(localStorage.getItem('nexplayy_ranges')) || [];
            ranges = ranges.filter(r => r !== range);
            localStorage.setItem('nexplayy_ranges', JSON.stringify(ranges));
            loadRanges();
        }

        function loadBanners() {
            const bannersData = JSON.parse(localStorage.getItem('nexplayy_banners')) || [];
            const list = document.getElementById('bannersList');
            list.innerHTML = '';
            
            if (bannersData.length === 0) {
                list.innerHTML = '<p style="color: var(--text-dim);">No banners yet. Create one!</p>';
                return;
            }

            bannersData.forEach((b, idx) => {
                const card = document.createElement('div');
                card.style.cssText = 'background: rgba(0,245,255,0.05); border: 1px solid rgba(0,245,255,0.2); border-radius: 8px; padding: 15px; margin-bottom: 12px;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4 style="color: var(--primary-color); margin-bottom: 5px;">${b.title}</h4>
                            <p style="color: var(--text-dim); font-size: 0.9rem; margin-bottom: 5px;">${b.desc}</p>
                            ${b.link ? `<p style="color: var(--secondary-color); font-size: 0.85rem;"><i class="fas fa-link"></i> ${b.link}</p>` : ''}
                        </div>
                        <button class="btn btn-outline btn-small" onclick="deleteBanner(${idx})">Delete</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function openBannerModal() {
            editingBannerId = null;
            document.getElementById('bannerTitle').value = '';
            document.getElementById('bannerDesc').value = '';
            document.getElementById('bannerLink').value = '';
            document.getElementById('bannerModal').style.display = 'flex';
        }

        function closeBannerModal() {
            document.getElementById('bannerModal').style.display = 'none';
        }

        function saveBanner() {
            const title = document.getElementById('bannerTitle').value.trim();
            const desc = document.getElementById('bannerDesc').value.trim();
            const link = document.getElementById('bannerLink').value.trim();

            if (!title || !desc) return alert('Fill in title and description');

            let banners = JSON.parse(localStorage.getItem('nexplayy_banners')) || [];
            banners.push({ title, desc, link });
            localStorage.setItem('nexplayy_banners', JSON.stringify(banners));
            closeBannerModal();
            loadBanners();
            alert('Banner added!');
        }

        function deleteBanner(idx) {
            let banners = JSON.parse(localStorage.getItem('nexplayy_banners')) || [];
            banners.splice(idx, 1);
            localStorage.setItem('nexplayy_banners', JSON.stringify(banners));
            loadBanners();
        }

        function loadFeatured() {
            const featured = JSON.parse(localStorage.getItem('nexplayy_featured')) || [];
            const list = document.getElementById('featuredAdminList');
            list.innerHTML = '';
            
            if (featured.length === 0) {
                list.innerHTML = '<p style="color: var(--text-dim);">No featured games yet.</p>';
                return;
            }

            featured.forEach((f, idx) => {
                const card = document.createElement('div');
                card.style.cssText = 'background: rgba(255,0,110,0.05); border: 1px solid rgba(255,0,110,0.2); border-radius: 8px; padding: 12px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;';
                card.innerHTML = `
                    <div>
                        <strong style="color: var(--primary-color);">${f.name}</strong>
                        <p style="color: var(--text-dim); font-size: 0.85rem; margin: 5px 0;">${f.note || 'No note'}</p>
                    </div>
                    <button class="btn btn-outline btn-small" onclick="deleteFeatured(${idx})">Remove</button>
                `;
                list.appendChild(card);
            });
        }

        function openFeaturedModal() {
            const gamesData = JSON.parse(localStorage.getItem('nexplayy_games')) || [];
            const select = document.getElementById('featuredGameName');
            select.innerHTML = '<option>Select a game...</option>';
            gamesData.forEach(g => {
                const opt = document.createElement('option');
                opt.value = g.name;
                opt.textContent = g.name;
                select.appendChild(opt);
            });
            document.getElementById('featuredNote').value = '';
            document.getElementById('featuredModal').style.display = 'flex';
        }

        function closeFeaturedModal() {
            document.getElementById('featuredModal').style.display = 'none';
        }

        function saveFeatured() {
            const name = document.getElementById('featuredGameName').value;
            const note = document.getElementById('featuredNote').value.trim();

            if (!name || name === 'Select a game...') return alert('Select a game');

            let featured = JSON.parse(localStorage.getItem('nexplayy_featured')) || [];
            featured.push({ name, note });
            localStorage.setItem('nexplayy_featured', JSON.stringify(featured));
            closeFeaturedModal();
            loadFeatured();
            alert('Added to featured!');
        }

        function deleteFeatured(idx) {
            let featured = JSON.parse(localStorage.getItem('nexplayy_featured')) || [];
            featured.splice(idx, 1);
            localStorage.setItem('nexplayy_featured', JSON.stringify(featured));
            loadFeatured();
        }

        function loadBundles() {
            const bundlesData = JSON.parse(localStorage.getItem('nexplayy_bundles')) || [];
            const list = document.getElementById('bundlesAdminList');
            list.innerHTML = '';
            
            if (bundlesData.length === 0) {
                list.innerHTML = '<p style="color: var(--text-dim);">No bundles yet.</p>';
                return;
            }

            bundlesData.forEach((b, idx) => {
                const card = document.createElement('div');
                card.style.cssText = 'background: rgba(0,255,65,0.05); border: 1px solid rgba(0,255,65,0.2); border-radius: 8px; padding: 15px; margin-bottom: 12px;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div>
                            <h4 style="color: var(--success-color); margin-bottom: 5px;">${b.name}</h4>
                            <p style="color: var(--text-dim); font-size: 0.9rem;">${b.description || 'No description'}</p>
                        </div>
                        <button class="btn btn-outline btn-small" onclick="deleteBundle(${idx})">Delete</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function openBundleModal() {
            const gamesData = JSON.parse(localStorage.getItem('nexplayy_games')) || [];
            const list = document.getElementById('bundleGamesList');
            list.innerHTML = '';
            
            gamesData.forEach(g => {
                const label = document.createElement('label');
                label.style.cssText = 'display: flex; align-items: center; gap: 10px; padding: 8px; cursor: pointer; color: var(--text-main);';
                const input = document.createElement('input');
                input.type = 'checkbox';
                input.className = 'bundle-game-check';
                input.value = g.name;
                label.appendChild(input);
                label.appendChild(document.createTextNode(g.name));
                list.appendChild(label);
            });

            document.getElementById('bundleName').value = '';
            document.getElementById('bundleDesc').value = '';
            document.getElementById('bundleModal').style.display = 'flex';
        }

        function closeBundleModal() {
            document.getElementById('bundleModal').style.display = 'none';
        }

        function saveBundle() {
            const name = document.getElementById('bundleName').value.trim();
            const description = document.getElementById('bundleDesc').value.trim();
            const checks = document.querySelectorAll('.bundle-game-check:checked');
            const gameIds = Array.from(checks).map(c => c.value);

            if (!name || gameIds.length === 0) return alert('Enter name and select games');

            let bundles = JSON.parse(localStorage.getItem('nexplayy_bundles')) || [];
            bundles.push({ name, description, gameIds });
            localStorage.setItem('nexplayy_bundles', JSON.stringify(bundles));
            closeBundleModal();
            loadBundles();
            alert('Bundle created!');
        }

        function deleteBundle(idx) {
            let bundles = JSON.parse(localStorage.getItem('nexplayy_bundles')) || [];
            bundles.splice(idx, 1);
            localStorage.setItem('nexplayy_bundles', JSON.stringify(bundles));
            loadBundles();
        }

        function loadGames() {
            const gamesData = JSON.parse(localStorage.getItem('nexplayy_games')) || [];
            const list = document.getElementById('gamesList');
            list.innerHTML = '';

            gamesData.forEach((g, idx) => {
                const card = document.createElement('div');
                card.style.cssText = 'background: rgba(0,162,255,0.05); border: 1px solid rgba(0,162,255,0.2); border-radius: 8px; padding: 12px; margin-bottom: 10px;';
                card.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start;">
                        <div style="flex: 1;">
                            <h5 style="color: var(--primary-color); margin-bottom: 4px;">${g.name}</h5>
                            <p style="color: var(--text-dim); font-size: 0.85rem; margin: 2px 0;">‚Çπ${g.price} | ${g.platform}</p>
                            ${g.badge ? `<span style="color: var(--accent-color); font-size: 0.75rem;">${g.badge}</span>` : ''}
                        </div>
                        <button class="btn btn-outline btn-small" onclick="deleteGame(${idx})">Delete</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function openGameModal() {
            editingGameIdx = null;
            loadGameFormRanges();
            document.getElementById('gameName').value = '';
            document.getElementById('gamePrice').value = '';
            document.getElementById('gameOldPrice').value = '';
            document.getElementById('gamePlatform').value = '';
            document.getElementById('gameImage').value = '';
            document.getElementById('gameBadge').value = '';
            document.getElementById('gameDesc').value = '';
            document.getElementById('gameModal').style.display = 'flex';
        }

        function closeGameModal() {
            document.getElementById('gameModal').style.display = 'none';
        }

        function loadGameFormRanges() {
            const ranges = JSON.parse(localStorage.getItem('nexplayy_ranges')) || [];
            const select = document.getElementById('gameRange');
            select.innerHTML = '<option>Select range...</option>';
            ranges.forEach(r => {
                const opt = document.createElement('option');
                opt.value = r;
                opt.textContent = `‚Çπ${r} Range`;
                select.appendChild(opt);
            });
        }

        function saveGame() {
            const name = document.getElementById('gameName').value.trim();
            const price = parseInt(document.getElementById('gamePrice').value);
            const oldPrice = parseInt(document.getElementById('gameOldPrice').value) || 0;
            const range = document.getElementById('gameRange').value;
            const platform = document.getElementById('gamePlatform').value.trim();
            const image = document.getElementById('gameImage').value.trim();
            const badge = document.getElementById('gameBadge').value.trim();
            const desc = document.getElementById('gameDesc').value.trim();

            if (!name || !price || range === 'Select range...' || !platform || !image) {
                return alert('Fill in all required fields');
            }

            const game = { name, price, oldPrice: oldPrice || undefined, range, platform, image, badge: badge || undefined, description: desc || undefined };

            let gamesData = JSON.parse(localStorage.getItem('nexplayy_games')) || [];
            if (editingGameIdx !== null) {
                gamesData[editingGameIdx] = game;
            } else {
                gamesData.push(game);
            }
            localStorage.setItem('nexplayy_games', JSON.stringify(gamesData));
            closeGameModal();
            loadGames();
            alert('Game saved!');
        }

        function deleteGame(idx) {
            let gamesData = JSON.parse(localStorage.getItem('nexplayy_games')) || [];
            gamesData.splice(idx, 1);
            localStorage.setItem('nexplayy_games', JSON.stringify(gamesData));
            loadGames();
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('nexplayy_settings')) || {};
            document.getElementById('sAutoplay').value = settings.autoplay !== false ? 'true' : 'false';
            document.getElementById('sAutoplayInterval').value = settings.autoplayInterval || 5000;
        }

        function updateSettings() {
            const settings = {
                autoplay: document.getElementById('sAutoplay').value === 'true',
                autoplayInterval: parseInt(document.getElementById('sAutoplayInterval').value),
                animations: true,
                showBundles: true
            };
            localStorage.setItem('nexplayy_settings', JSON.stringify(settings));
            alert('Settings updated!');
        }

        // Load dashboard on startup
        window.addEventListener('DOMContentLoaded', () => {
            const password = localStorage.getItem('nexplayy_admin_logged_in');
            if (password === 'true') {
                document.getElementById('loginGate').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            }
        });

        function checkLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                localStorage.setItem('nexplayy_admin_logged_in', 'true');
                document.getElementById('loginGate').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            } else {
                alert('Incorrect password');
            }
        }

        function logout() {
            localStorage.removeItem('nexplayy_admin_logged_in');
            document.getElementById('loginGate').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }
    </script>
</body>

</html>
